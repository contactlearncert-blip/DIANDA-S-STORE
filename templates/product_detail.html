<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    
    <title>{{ product.name }} - DIANDA S'STORE</title>
    <meta name="description" content="{{ product.description[:150] }}">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Skip to content (accessibilitÃ©) -->
    <a href="#main-content" class="visually-hidden">Aller au contenu</a>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <span>ðŸ“ž Appelez-nous : <strong>+226 76 59 39 14</strong></span>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <button class="hamburger" id="menuToggle" aria-label="Menu">â˜°</button>
            
            <div class="logo-section">
                <a href="/" class="logo-link">
                    <img src="{{ url_for('static', filename='img/logo.png') }}" alt="DIANDA S'STORE" class="logo-img">
                    <span class="logo">DIANDA S'STORE</span>
                </a>
            </div>
            
            <button class="btn-cart" id="cartToggle" aria-label="Panier">
                <span class="cart-icon">ðŸ›’</span>
                <span class="cart-count" id="cartCount">0</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container">
        <div class="product-detail">
            <!-- Image -->
            <div class="product-detail-image">
                <img src="{{ product.image }}" alt="{{ product.name }}" 
                     onerror="this.src='{{ url_for('static', filename='img/placeholder.png') }}'">
            </div>
            
            <!-- Informations produit -->
            <div class="product-detail-info">
                <span class="product-category-badge">{{ product.category }}</span>
                <h1>{{ product.name }}</h1>
                
                <p class="product-description-full">{{ product.description }}</p>
                
                <div class="product-detail-price">
                    {{ product.price }} FCFA
                </div>
                
                <!-- Actions : QuantitÃ© + Ajout au panier -->
                <div class="product-detail-actions">
                    <!-- SÃ©lecteur de quantitÃ© -->
                    <div class="quantity-selector">
                        <button class="qty-btn" onclick="decreaseQty()" aria-label="Diminuer la quantitÃ©">âˆ’</button>
                        <span class="qty-display" id="quantity">1</span>
                        <button class="qty-btn" onclick="increaseQty()" aria-label="Augmenter la quantitÃ©">+</button>
                    </div>
                    
                    <!-- Bouton Ajouter au panier -->
                    <button class="btn-add-to-cart" id="addToCartBtn"
                        data-id="{{ product.id }}"
                        data-name="{{ product.name }}"
                        data-price="{{ product.price }}">
                        Ajouter au panier
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Menu Mobile -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <h3>Menu</h3>
            <button class="mobile-menu-close" id="closeMenu" aria-label="Fermer le menu">âœ•</button>
        </div>
        <nav class="mobile-menu-nav">
            <a href="/">Tous les Produits</a>
            <a href="/?category=VÃªtements">VÃªtements</a>
            <a href="/?category=Accessoires">Accessoires</a>
            <a href="/?category=Chaussures">Chaussures</a>
            <a href="/?category=Bijoux">Bijoux</a>
            <a href="/about">Ã€ propos</a>
        </nav>
    </div>
    <div class="mobile-menu-backdrop" id="menuBackdrop"></div>

    <!-- Modal Panier - CORRIGÃ‰ : suppression des points de suspension -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <button class="close" id="closeCart" aria-label="Fermer le panier">âœ•</button>
            <h2>Votre Panier</h2>
            <div id="cartItems">
                <!-- Le contenu sera chargÃ© dynamiquement par script.js -->
            </div>
            <div class="cart-total">
                <strong>Total: <span id="cartTotal">0</span> FCFA</strong>
            </div>
            <button class="btn-checkout" id="checkoutBtn">
                Commander sur WhatsApp
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>DIANDA S'STORE</h3>
                    <p>Votre boutique de mode Ã  Ouagadougou</p>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>ðŸ“ž +226 76 59 39 14</p>
                    <p>ðŸ“§ diandakarim45@gmail.com</p>
                </div>
                <div class="footer-section">
                    <h4>Liens</h4>
                    <ul>
                        <li><a href="/about">Ã€ propos</a></li>
                        <li><a href="/cgv">CGV</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 DIANDA S'STORE - Ouagadougou, Burkina Faso</p>
            </div>
        </div>
    </footer>

    <!-- Script principal (tout le JS est dans ce fichier externe) -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    
    <!-- Script spÃ©cifique Ã  la page dÃ©tail -->
    <script>
        // Variables et fonctions pour la gestion de la quantitÃ©
        let qty = 1;
        
        function increaseQty() { 
            qty++; 
            document.getElementById('quantity').textContent = qty; 
        }
        
        function decreaseQty() { 
            if (qty > 1) { 
                qty--; 
                document.getElementById('quantity').textContent = qty; 
            } 
        }
        
        // Ajout au panier depuis la page dÃ©tail
        document.getElementById('addToCartBtn').addEventListener('click', function() {
            const btn = this;
            const id = btn.dataset.id;
            const name = btn.dataset.name;
            const price = parseInt(btn.dataset.price);
            
            // Ajouter la quantitÃ© sÃ©lectionnÃ©e
            for(let i = 0; i < qty; i++) {
                if (typeof window.addToCart === 'function') {
                    window.addToCart(id, name, price);
                }
            }
            
            // Afficher une notification
            if (typeof window.showNotification === 'function') {
                window.showNotification(`${qty} Ã— ${name} ajoutÃ©(s) au panier`);
            }
            
            // RÃ©initialiser la quantitÃ©
            qty = 1;
            document.getElementById('quantity').textContent = qty;
        });
        
        // Fonction pour fermer le menu mobile
        window.closeMobileMenu = function() {
            const menu = document.getElementById('mobileMenu');
            const backdrop = document.getElementById('menuBackdrop');
            if (menu) menu.classList.remove('active');
            if (backdrop) backdrop.classList.remove('active');
            document.body.style.overflow = '';
        };
        
        // VÃ©rification que le panier est bien initialisÃ©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page dÃ©tail chargÃ©e');
            // S'assurer que le compteur du panier est mis Ã  jour
            if (typeof window.updateCartCount === 'function') {
                window.updateCartCount();
            }
        });
    </script>
</body>
</html>